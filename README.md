# Introduction to Authentication Module Project

## Introduction

Use `Node.js`, `Express` and `Knex` to build an API that provides register, login and logout functionality.

## Instructions

### Task 1: Project Setup and Submission

Your assignment page on Canvas should contain instructions for submitting this project. If you are still unsure, reach out to School Staff.

### Task 2: Minimum Viable Product

#### 2A - Database Access Functions

Write the following user access functions inside `api/users/users-model.js`:

- [ ] `find`
- [ ] `findBy`
- [ ] `findById`
- [ ] `add`

#### 2B - Middleware Functions

Write the following auth middlewares inside `api/auth/auth-middleware.js`:

- [ ] `restricted`
- [ ] `checkUsernameFree`
- [ ] `checkPasswordLength`
- [ ] `checkUsernameExists`

#### 2C - Endpoints

Authentication will be tracked using sessions and cookies. See `api/server.js` for more instructions.

Write the following endpoints. The first one belongs inside `api/users/users-router.js` and the rest inside `api/auth/auth-router.js`:

- [ ] `[GET] /api/users`
- [ ] `[POST] /api/auth/register`
- [ ] `[POST] /api/auth/login`
- [ ] `[GET] /api/auth/logout`

#### Users Schema

The database `auth.db3` includes a single `users` table:

| field    | data type        | metadata                                      |
| :------- | :--------------- | :-------------------------------------------- |
| user_id  | unsigned integer | primary key, auto-increments, generated by db |
| username | string           | required, unique                              |
| password | string           | required                                      |

#### Notes

- Run tests locally executing `npm test`.
- The project comes with `migrate`, `rollback` and `seed` scripts in case you need to reset the database.
- You are welcome to create additional files but **do not move or rename existing files** or folders.
- Do not alter your `package.json` file except to install extra libraries or add extra scripts. Do not update existing libraries.
- In your solution, it is essential that you follow best practices and produce clean and professional results.
- Schedule time to review, refine, and assess your work.
- Perform basic professional polishing including spell-checking and grammar-checking on your work.

### Task 3: Stretch Goals

- Build a React application that implements components to register, login and view a list of users. Gotta keep sharpening your React skills.

<!--
# Tests

    [x] [0] sanity check (33 ms)
    server.js
## [POST] /api/auth/login
    [ ] [1] responds with the correct message on valid credentials (23 ms)
    [ ] [2] a "chocolatechip" cookie gets set on the client on valid credentials (5 ms)
    [x] [3] no cookie gets set on invalid credentials (saveUninitialized=false) (4 ms)
    [ ] [4] responds with the correct message on invalid credentials (4 ms)

## [POST] /api/auth/register
    [ ] [5] creates a new user in the database (4 ms)
    [ ] [6] new user passwords are saved correctly bcrypted (3 ms)
    [x] [7] no cookie gets set by registering (saveUninitialized=false) (4 ms)
    [ ] [8] responds with the user (user_id and username) (6 ms)
    [x] [9] responds with the proper status code and message on "username taken" (3 ms)
    [x] [10] responds with the proper status code and message on too short a password (3 ms)

## [GET] /api/auth/logout
    [ ] [11] if there is a session it is destroyed so "chocolatechip" cookie not effective anymore (3 ms)
    [ ] [12] responds with the proper message if the user was not actually logged in (9 ms)

## [GET] /api/users
    [ ] [13] responds with the proper status code and message on not-logged-in user (6 ms)
    [ ] [14] responds with the users if there is a session matching the "chocolatechip" cookie (6 ms)

 -->
